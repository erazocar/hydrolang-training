"use strict";(self.webpackChunkhydrolang_training=self.webpackChunkhydrolang_training||[]).push([[387],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),d=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=d(a),h=i,m=p["".concat(l,".").concat(h)]||p[h]||u[h]||r;return a?n.createElement(m,o(o({ref:t},c),{},{components:a})):n.createElement(m,o({ref:t},c))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:i,o[1]=s;for(var d=2;d<r;d++)o[d]=a[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},1668:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var n=a(7462),i=(a(7294),a(3905));const r={sidebar_position:6},o="Case Study: Data Visualization Deck",s={unversionedId:"tutorial/case-study1",id:"tutorial/case-study1",title:"Case Study: Data Visualization Deck",description:"For this case study, we will create a simple dashboard with data retrieval, mapping capabilities, and data calculation all using the HydroLang framework using the functions highlighted throughout the period from 1950s to 2023.",source:"@site/docs/tutorial/case-study1.mdx",sourceDirName:"tutorial",slug:"/tutorial/case-study1",permalink:"/tutorials/hydrolang/build/index.html/docs/tutorial/case-study1",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"NN",permalink:"/tutorials/hydrolang/build/index.html/docs/tutorial/analyze/nn"},next:{title:"Case Study: BMI Coupling",permalink:"/tutorials/hydrolang/build/index.html/docs/tutorial/case-study2"}},l={},d=[{value:"Purpose",id:"purpose",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Retrieving and Preprocessing Data",id:"retrieving-and-preprocessing-data",level:2},{value:"Visualizing Stations on the Map",id:"visualizing-stations-on-the-map",level:2},{value:"Creating Charts and Stats on Screen",id:"creating-charts-and-stats-on-screen",level:2}],c={toc:d},p="wrapper";function u(e){let{components:t,...a}=e;return(0,i.kt)(p,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"case-study-data-visualization-deck"},"Case Study: Data Visualization Deck"),(0,i.kt)("p",null,"For this case study, we will create a simple dashboard with data retrieval, mapping capabilities, and data calculation all using the HydroLang framework using the functions highlighted throughout the period from 1950s to 2023."),(0,i.kt)("h2",{id:"purpose"},"Purpose"),(0,i.kt)("p",null,"This case study demonstrates how HydroLang can enable the development of fast web applications with real-time data retrieval and integration capabilities."),(0,i.kt)("h2",{id:"getting-started"},"Getting Started"),(0,i.kt)("p",null,"We will have in an HTML document a few ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements that will function as holder spaces for our website development. Specifically, we will create a web page with a map that shows stations in the Salt Lake City area."),(0,i.kt)("p",null,"The basic HTML elements that we need are the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<body>\n    <div id="map"></div>\n    <div id="overlay">\n        <div id="content">\n            <div id="retrieved-data"></div>\n            <div id="stats-table"></div>\n            <button id="download-btn">Download Data</button>\n        </div>\n    </div>\n    <script src="src/main.js"><\/script>\n</body>\n')),(0,i.kt)("p",null,"When we retrieve data from a specific station, an overlay will go over the web page showing a chart and statistics for the retrived dataset."),(0,i.kt)("p",null,"Inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"main.js")," file, let's create an instance of the HydroLang library, as well as an array that will be used for storing data retrieved from a particular station."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const hydro = new Hydrolang();\nwindow.clean_stations = [];\n")),(0,i.kt)("admonition",{title:"Note",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Declaring a window object allows for a variable to be available everywehre in an application.")),(0,i.kt)("p",null,"We will also create a a function that will be used to execute the code we will write:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"async function main(){\n  //Execute functions here\n}\nmain()\n")),(0,i.kt)("h2",{id:"retrieving-and-preprocessing-data"},"Retrieving and Preprocessing Data"),(0,i.kt)("p",null,"We can initialize the map inside the main function using"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'async function main() {\n  hydro.map.renderMap({ params: { maptype: "leaflet", lat: 40.75, lon: -111.87 }});\n}\n')),(0,i.kt)("p",null,"Let's retrieve stations within a bounding box in south west SLC. We can do this by creating a function that will be called afterwards:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'async function retrieveData() {\n  let data = await hydro.data.retrieve({\n    params: { source: "waterOneFlow", datatype: "GetSitesByBoxObject" },\n    args: { \n      sourceType: "USGS Daily Values",\n      east: -111.5592,\n      west: -112.037,\n      north: 41.07,\n      south: 40.5252\n    }\n  });\n  return data;\n}\n')),(0,i.kt)("p",null,"We can create another function that will call the retrieveData function and transform it so that we can use it to create markers on our map. Additionally, we will create popups for each of the stations that display the name, location, and the variable it serves."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'async function renderLocations() {\n  let raw_stations = hydro.data.transform({\n    params: { save: "site" },\n    args: { type: "JSON" },\n    data: await retrieveData()\n  });\n\n  for (let station of raw_stations) {\n    //...\n  }\n')),(0,i.kt)("p",null,"We can extract the necessary information from the retrieved stations to create popups for each station on the map. With the cleaned station data, we can then populate the map with the necessary markers."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"renderLocations(){\n  //...\n  for (let station of raw_stations) {\n    let stgProps = {};\n    stgProps.name = station.siteInfo.siteName;\n    stgProps.location = station.siteInfo.geoLocation.geogLocation;\n    stgProps.siteCode = station.siteInfo.siteCode;\n    stgProps.variable = station.seriesCatalog.series.variable;\n    clean_stations.push(stgProps);\n  }\n\n  for (let station of clean_stations) {\n    //...\n  }\n  \n")),(0,i.kt)("h2",{id:"visualizing-stations-on-the-map"},"Visualizing Stations on the Map"),(0,i.kt)("p",null,"We can add a popup to each station marker that displays important information about the station, such as its name and location. Additionally, we can include a button within the popup that, when clicked, retrieves the station's time series data for the specified case study timeframe."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'  for (let station of clean_stations) {\n    const button = document.createElement("button");\n    button.textContent = "Retrieve Data";\n\n    button.addEventListener("click", function () {\n      retrieveValues(station.siteCode);\n    });\n    const popUpContent = document.createElement("div");\n    popUpContent.innerHTML = `<h4>Station Information</h4>\n    <ul>\n      <li><strong>Name:</strong>${station.name}</li>\n      <li><strong>Latitude:</strong>${station.location.latitude}</li>\n      <li><strong>Longitude:</strong>${station.location.longitude}</li>\n      <li><strong>Variable:</strong>${\n        station.variable && station.variable.variableName\n          ? station.variable.variableName\n          : "NV"\n      }</li>\n    </ul>`;\n    popUpContent.appendChild(button);\n')),(0,i.kt)("p",null,"The popup variable contains html tag elements that can be rendered as dynamic text for each station. We are also calling a function with the newly created button to download the data for that particular station. To render the maps on screen, we will be calling the ",(0,i.kt)("inlineCode",{parentName:"p"},"Layers")," function for each station."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'async function renderLocations() {\n  //...\n  for (let station of clean_stations) {\n    //...\n    hydro.map.Layers({\n      args: {\n        type: "marker",\n        name: `${station.siteCode}`,\n        popUp: popUpContent\n      },\n      data: [\n        JSON.parse(station.location.latitude),\n        JSON.parse(station.location.longitude)\n      ]\n    });\n  }\n}\n')),(0,i.kt)("h2",{id:"creating-charts-and-stats-on-screen"},"Creating Charts and Stats on Screen"),(0,i.kt)("p",null,"We can now retrieve data for each station if we click on them. To do this, we use the ",(0,i.kt)("inlineCode",{parentName:"p"},"retrieveValues")," function:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'async function retrieveValues(site) {\n  //Display properties\n\n  let usgs_query = {\n    source: "usgs",\n    datatype: "daily-values",\n    transform: true\n  };\n  let args_query = {\n    site: site,\n    format: "json",\n    startDt: "1950-01-01",\n    endDt: "2023-01-01"\n  };\n\n  let usgs_data = await hydro.data.retrieve({\n    params: usgs_query,\n    args: args_query\n  });\n  hydro.visualize.draw({\n    params: { type: "chart", id: "retrieved-data" },\n    data: usgs_data\n  });\n  hydro.visualize.draw({\n    params: { type: "table", id: "stats-table" },\n    data: hydro.analyze.stats.basicstats({ data: usgs_data })\n  });\n  //Display properties\n}\n')),(0,i.kt)("p",null,"With this, we are finished with the case study. There only thing missing is calling the ",(0,i.kt)("inlineCode",{parentName:"p"},"renderLocations")," function inside ",(0,i.kt)("inlineCode",{parentName:"p"},"main"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'async function main() {\n  hydro.map.renderMap({\n    params: { maptype: "leaflet", lat: 40.75, lon: -111.87 }\n  });\n  renderLocations();\n}\n\nmain();\n')),(0,i.kt)("admonition",{title:"Note",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"We have used ",(0,i.kt)("inlineCode",{parentName:"p"},"async")," throughout the case study in the functions that have to wait for results to return from servers. This is an easier way to deal with asynchronous calls, however you can also use ",(0,i.kt)("inlineCode",{parentName:"p"},"Promises")," and chaining methods together.")),(0,i.kt)("p",null,"You can update the playground below and see results of the case study."),(0,i.kt)("br",null),(0,i.kt)("iframe",{src:"https://codesandbox.io/embed/case-study-1-dimbnw?codemirror=1&fontsize=14&hidenavigation=1&theme=light",width:"100%",height:"300px",border:"0","border-radius":"4px",title:"case-study-1",allow:"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking",sandbox:"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}))}u.isMDXComponent=!0}}]);